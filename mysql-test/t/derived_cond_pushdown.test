create table t1 (a int, b int, c int);
create table t2 (a int, b int, c int, d decimal);
insert into t1 values 
  (1,21,345), (1,33,7), (8,33,114), (1,21,500), (1,19,107), (5,14,787),
  (8,33,123), (9,10,211), (5,16,207), (1,33,988), (5,27,132), (1,21,104),
  (6,20,309), (6,20,315), (1,21,101), (8,33,404), (9,10,800), (1,21,123),
  (7,11,708), (6,20,214);
insert into t2 values
  (2,3,207,207.0000), (1,21,909,12.0000), (7,13,312,406.0000), 
  (8,64,248,107.0000), (6,20,315,279.3333), (1,19,203,107.0000),
  (8,80,800,314.0000), (3,12,231,190.0000), (6,23,303,909.0000);

create view v1 as select a, b, max(c) as max_c, avg(c) as avg_c from t1 
  group by a,b having max_c < 707;
  
select * from v1,t2 where (v1.max_c>214) and (t2.a>v1.a);
explain format=json select * from v1,t2 where (v1.max_c>214) and (t2.a>v1.a);

select * from v1,t2 where 
  ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));
explain format=json
  select * from v1,t2 where 
    ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));
    
select * from v1,t2 where (v1.a>6) and (t2.b>v1.b);
explain format=json select * from v1,t2 where (v1.a>6) and (t2.b>v1.b);   
    
select * from v1,t2 where 
  ((v1.a>7) and (t2.c<v1.max_c)) or ((v1.a<2) and (t2.b<v1.b));
explain format=json
  select * from v1,t2 where 
    ((v1.a>7) and (t2.c<v1.max_c)) or ((v1.a<2) and (t2.b<v1.b));

select * from v1,t2 where (v1.a<2) and (v1.max_c>400) and (t2.b>v1.b);
explain format=json 
  select * from v1,t2 where (v1.a<2) and (v1.max_c>400) and (t2.b>v1.b);      

select * from v1,t2 where 
  ((v1.a>7) and (v1.max_c>300) and (t2.c<v1.max_c)) or 
  ((v1.a<4) and (v1.max_c<500) and (t2.b<v1.b));
explain format=json
  select * from v1,t2 where 
    ((v1.a>7) and (v1.max_c>300) and (t2.c<v1.max_c)) or 
    ((v1.a<4) and (v1.max_c<500) and (t2.b<v1.b)); 

select * from v1,t2 where ((v1.a<2) and (v1.max_c>120)) or (v1.a>7);
explain format=json 
  select * from v1,t2 where ((v1.a<2) and (v1.max_c>120)) or (v1.a>7);
    
create view v2 as select a, b, max(c) as max_c, avg(c) as avg_c from t1 
  where t1.a>5 group by a,b having max_c < 707;

select * from v2,t2 where (v2.b>25) and (t2.a<v2.a);
explain format=json select * from v2,t2 where (v2.b>25) and (t2.a<v2.a); 

select * from v2,t2 where 
  ((v2.a>7) and (t2.c<v2.max_c)) or ((v2.a>5) and (t2.b<v2.b));
explain format=json 
  select * from v2,t2 where 
   ((v2.a>7) and (t2.c<v2.max_c)) or ((v2.a>5) and (t2.b<v2.b));
   
prepare stmt from "select * from v1,t2 where 
  ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));";
execute stmt;
execute stmt;
deallocate prepare stmt;

prepare stmt from 
  "explain format=json select * from v1,t2 where 
    ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));";
execute stmt;
execute stmt;
deallocate prepare stmt;

select * from v1,t2 where (t2.a<5) and (v1.a=t2.a);
explain format=json select * from v1,t2 where (t2.a<5) and (v1.a=t2.a);

select * from v1,t2 where (t2.c>150) and (v1.max_c=t2.c);
explain format=json select * from v1,t2 where (t2.c>150) and (v1.max_c=t2.c);

select * from v1,t2
  where ((t2.a>5) and (v1.a=t2.a)) and ((t2.c>250) and (v1.max_c=t2.c));
explain format=json
  select * from v1,t2
    where ((t2.a>5) and (v1.a=t2.a)) and ((t2.c>250) and (v1.max_c=t2.c));
   
select * from v1,t2
  where ((t2.a<4) and (v1.a=t2.a)) or ((t2.c>150) and (v1.max_c=t2.c));
explain format=json
  select * from v1,t2
    where ((t2.a<4) and (v1.a=t2.a)) or ((t2.c>150) and (v1.max_c=t2.c));  