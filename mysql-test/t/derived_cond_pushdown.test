create table t1 (a int, b int, c int);
create table t2 (a int, b int, c int, d decimal);
insert into t1 values 
  (1,21,345), (1,33,7), (8,33,114), (1,21,500), (1,19,107), (5,14,787),
  (8,33,123), (9,10,211), (5,16,207), (1,33,988), (5,27,132), (1,21,104),
  (6,20,309), (6,20,315), (1,21,101), (8,33,404), (9,10,800), (1,21,123),
  (7,11,708), (6,20,214);
insert into t2 values
  (2,3,207,207.0000), (1,21,909,12.0000), (7,13,312,406.0000), 
  (8,64,248,107.0000), (6,20,315,279.3333), (1,19,203,107.0000),
  (8,80,800,314.0000), (3,12,231,190.0000), (6,23,303,909.0000);

create view v1 as select a, b, max(c) as max_c, avg(c) as avg_c from t1 
  group by a,b having max_c < 707;
  
select * from v1,t2 where (v1.max_c>214) and (t2.a>v1.a);
explain format=json select * from v1,t2 where (v1.max_c>214) and (t2.a>v1.a);

select * from v1,t2 where 
  ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));
explain format=json
  select * from v1,t2 where 
    ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));
    
select * from v1,t2 where (v1.a>6) and (t2.b>v1.b);
explain format=json select * from v1,t2 where (v1.a>6) and (t2.b>v1.b);   
    
select * from v1,t2 where 
  ((v1.a>7) and (t2.c<v1.max_c)) or ((v1.a<2) and (t2.b<v1.b));
explain format=json
  select * from v1,t2 where 
    ((v1.a>7) and (t2.c<v1.max_c)) or ((v1.a<2) and (t2.b<v1.b));

select * from v1,t2 where (v1.a<2) and (v1.max_c>400) and (t2.b>v1.b);
explain format=json 
  select * from v1,t2 where (v1.a<2) and (v1.max_c>400) and (t2.b>v1.b);      

select * from v1,t2 where 
  ((v1.a>7) and (v1.max_c>300) and (t2.c<v1.max_c)) or 
  ((v1.a<4) and (v1.max_c<500) and (t2.b<v1.b));
explain format=json
  select * from v1,t2 where 
    ((v1.a>7) and (v1.max_c>300) and (t2.c<v1.max_c)) or 
    ((v1.a<4) and (v1.max_c<500) and (t2.b<v1.b)); 

select * from v1,t2 where ((v1.a<2) and (v1.max_c>120)) or (v1.a>7);
explain format=json 
  select * from v1,t2 where ((v1.a<2) and (v1.max_c>120)) or (v1.a>7);
    
create view v2 as select a, b, max(c) as max_c, avg(c) as avg_c from t1 
  where t1.a>5 group by a,b having max_c < 707;

select * from v2,t2 where (v2.b>25) and (t2.a<v2.a);
explain format=json select * from v2,t2 where (v2.b>25) and (t2.a<v2.a); 

select * from v2,t2 where 
  ((v2.a>7) and (t2.c<v2.max_c)) or ((v2.a>5) and (t2.b<v2.b));
explain format=json 
  select * from v2,t2 where 
   ((v2.a>7) and (t2.c<v2.max_c)) or ((v2.a>5) and (t2.b<v2.b));
   
prepare stmt from "select * from v1,t2 where 
  ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));";
execute stmt;
execute stmt;
deallocate prepare stmt;

prepare stmt from 
  "explain format=json select * from v1,t2 where 
    ((v1.max_c>400) and (t2.a>v1.a)) or ((v1.max_c<135) and (t2.a<v1.a));";
execute stmt;
execute stmt;
deallocate prepare stmt;

select * from v1,t2 where (t2.a<5) and (v1.a=t2.a);
explain format=json select * from v1,t2 where (t2.a<5) and (v1.a=t2.a);

select * from v1,t2 where (t2.c>150) and (v1.max_c=t2.c);
explain format=json select * from v1,t2 where (t2.c>150) and (v1.max_c=t2.c);

select * from v1,t2
  where ((t2.a>5) and (v1.a=t2.a)) and ((t2.c>250) and (v1.max_c=t2.c));
explain format=json
  select * from v1,t2
    where ((t2.a>5) and (v1.a=t2.a)) and ((t2.c>250) and (v1.max_c=t2.c));
   
select * from v1,t2
  where ((t2.a<4) and (v1.a=t2.a)) or ((t2.c>150) and (v1.max_c=t2.c));
explain format=json
  select * from v1,t2
    where ((t2.a<4) and (v1.a=t2.a)) or ((t2.c>150) and (v1.max_c=t2.c));  
    
select * from v1,t2 where
  ((v1.max_c>300) and (v1.avg_c>t2.d) and (v1.b=t2.b)) or 
    ((v1.max_c<135) and (v1.max_c<t2.c) and (v1.a=t2.a));
explain format=json
  select * from v1,t2 where
    ((v1.max_c>300) and (v1.avg_c>t2.d) and (v1.b=t2.b)) or 
      ((v1.max_c<135) and (v1.max_c<t2.c) and (v1.a=t2.a)); 
      
select * from v1,t2 where 
  ((v1.a>4) and (v1.b>t2.b) and (v1.max_c=t2.d)) or 
    ((v1.a<2) and (v1.max_c<t2.c) and (v1.max_c=t2.d)); 
explain format=json
  select * from v1,t2 where 
    ((v1.a>4) and (v1.b>t2.b) and (v1.max_c=t2.d)) or 
      ((v1.a<2) and (v1.max_c<t2.c) and (v1.max_c=t2.d)); 
      
select * from v1,t2 where 
  (v1.a>3) and (v1.max_c>200) and (t2.b<v1.b) and (t2.d=v1.max_c);
explain format=json
  select * from v1,t2 where 
    (v1.a>3) and (v1.max_c>200) and (t2.b<v1.b) and (t2.d=v1.max_c);      
    
select * from v1,t2 where 
  ((v1.a<2) and (v1.max_c>120) and (v1.b=t2.b)) or (v1.a>7);   
explain format=json
  select * from v1,t2 where 
    ((v1.a<2) and (v1.max_c>120) and (v1.b=t2.b)) or (v1.a>7);
    
select * from v1,t2 where
  ((v1.a<2) and (v1.max_c<200) and (t2.c>v1.max_c) and (v1.max_c=t2.d)) or
    ((v1.a>4) and (v1.max_c<500) and (t2.b<v1.b) and (v1.max_c=t2.c));  
explain format=json
  select * from v1,t2 where
    ((v1.a<2) and (v1.max_c<200) and (t2.c>v1.max_c) and (v1.max_c=t2.d)) or
      ((v1.a>4) and (v1.max_c<500) and (t2.b<v1.b) and (v1.max_c=t2.c));
      
select * from v1,t2 where (t2.a<2) and (t2.c>900);
explain format=json 
  select * from v1,t2 where (t2.a<2) and (t2.c>900);     
      
select * from v1,t2 where 
  (t2.a<2) and (t2.c>900) and ((v1.a<t2.a) or (t2.a<11));
explain format=json 
  select * from v1,t2 where 
    (t2.a<2) and (t2.c>900) and ((v1.a<t2.a) or (t2.a<11));      
      
select * from v1,t2 where (v1.a=t2.a) and (v1.b=t2.b);
explain format=json select * from v1,t2 where (v1.a=t2.a) and (v1.b=t2.b);

select * from v1,t2 where (t2.a=v1.a) and (v1.b=t2.b) and (v1.a=1);
explain format=json 
  select * from v1,t2 where (t2.a=v1.a) and (v1.b=t2.b) and (v1.a=1);
  
select * from v1,t2 where 
  (t2.a=v1.a) or (v1.b=t2.b) and ((v1.a=1) or (v1.a=6)); 
explain format=json  
  select * from v1,t2 where 
    (t2.a=v1.a) or (v1.b=t2.b) and ((v1.a=1) or (v1.a=6)); 
    
select * from v1,t2 where (v1.a=5) and (v1.max_c=t2.d);    
explain format=json select * from v1,t2 where (v1.a=5) and (v1.max_c=t2.d);

select * from v1,t2 where (v1.a=1) and (v1.b=21) and (t2.a=2);
explain format=json 
  select * from v1,t2 where (v1.a=1) and (v1.b=21) and (t2.a=2);
  
select * from v1,t2 where (v1.a=1) or (v1.b=21) or (t2.a=2);
explain format=json 
  select * from v1,t2 where (v1.a=1) or (v1.b=21) or (t2.a=2);

select * from v1,t2 where (v1.a=1) or (v1.b=21) and (t2.a=2);  
explain format=json 
  select * from v1,t2 where (v1.a=1) or (v1.b=21) and (t2.a=2);  
  
select * from v1,t2 where (v1.a=v1.b) and (v1.a=t2.a);  
explain format=json 
  select * from v1,t2 where (v1.a=v1.b) and (v1.a=t2.a); 
  
select * from v1,t2 where (v1.a=v1.b) and (v1.a=t2.a) and (v1.a=3);
explain format=json 
  select * from v1,t2 where (v1.a=v1.b) and (v1.a=t2.a) and (v1.a=3);
  
select * from v1,v2,t2 where (v1.a=v2.a) and (v1.a=t2.a) and (v2.b<50);
explain format=json select * from v1,v2,t2 where 
  (v1.a=v2.a) and (v1.a=t2.a) and (v2.b<50);

select * from v1,v2,t2 where 
  ((v1.a=v2.a) or (v1.a=t2.a)) and (t2.b<50) and (v1.b=v2.b);
explain format=json 
  select * from v1,v2,t2 where 
    ((v1.a=v2.a) or (v1.a=t2.a)) and (t2.b<50) and (v1.b=v2.b);

select * from v1,v2,t2 where ((v1.a=v2.a) or (v1.a=t2.a)) and 
  ((v2.b<50) or (v2.b=19)) and (v1.max_c<300);
explain format=json 
  select * from v1,v2,t2 where ((v1.a=v2.a) or (v1.a=t2.a)) and 
    ((v2.b<50) or (v2.b=19)) and (v1.max_c<300);

select * from v1,v2,t2 where 
  ((v1.a=v2.a) and (v1.a=t2.a)) or ((v2.b>13) and (t2.c<115)); 
explain format=json 
  select * from v1,v2,t2 where 
    ((v1.a=v2.a) and (v1.a=t2.a)) or ((v2.b>13) and (t2.c<115));

select * from v1,v2,t2 where 
  (v1.a=t2.a) and (v1.a=v1.b) and (v1.a=v2.a) and (v2.max_c<300);
explain format=json 
  select * from v1,v2,t2 where 
    (v1.a=t2.a) and (v1.a=v1.b) and (v1.a=v2.a) and (v2.max_c<300); 

select * from v1,v2,t2 where (v1.a=8) and (v1.b>10) and (v1.b=v2.b);    
explain format=json 
  select * from v1,v2,t2 where (v1.a=1) and (v1.b>10) and (v1.b=v2.b);

create view v3 as select a, b, min(c) as min_c from t1
  where t1.a<10 group by a,b having min_c > 109;

select * from v1,v2,v3,t2 where 
  ((v1.a=v2.a) or (v1.a=t2.a)) and ((v3.b<50) or (v3.b=33)) 
    and (v1.max_c<500) and (v3.a=t2.a) and (v2.max_c>300);
explain format=json 
  select * from v1,v2,v3,t2 where 
    ((v1.a=v2.a) or (v1.a=t2.a)) and ((v3.b<50) or (v3.b=33)) 
      and (v1.max_c<500) and (v3.a=t2.a) and (v2.max_c>300);
      
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    group by a,b having max_c < 707) v1, 
      t2 where (v1.a=t2.a) and (v1.max_c>300);
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      group by a,b having max_c < 707) v1, 
        t2 where (v1.a=t2.a) and (v1.max_c>300);
        
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    group by a,b having max_c < 707) v1, 
      t2 where ((v1.a=1) or (v1.max_c<300)) and (v1.b>25); 
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      group by a,b having max_c < 707) v1, 
        t2 where ((v1.a=1) or (v1.max_c<300)) and (v1.b>25); 
        
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    group by a,b having max_c < 707) v1, 
      t2 where ((v1.max_c>300) and (v1.avg_c>t2.d) and (v1.b=t2.b)) or 
        ((v1.max_c<135) and (v1.max_c<t2.c) and (v1.a=t2.a));         
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      group by a,b having max_c < 707) v1, 
        t2 where ((v1.max_c>300) and (v1.avg_c>t2.d) and (v1.b=t2.b)) or 
          ((v1.max_c<135) and (v1.max_c<t2.c) and (v1.a=t2.a));       
          
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    group by a,b having max_c < 707) v1, 
      t2 where (v1.a=8) and (v1.a=t2.a) and (v1.max_c=404);
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      group by a,b having max_c < 707) v1, 
        t2 where (v1.a=8) and (v1.a=t2.a) and (v1.max_c=404);
        
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    where t1.a>5 group by a,b having max_c < 707) v1, 
      t2 where (v1.a=t2.a) and (v1.max_c>300) and (v1.b<30);        
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      where t1.a>5 group by a,b having max_c < 707) v1, 
        t2 where (v1.a=t2.a) and (v1.max_c>300) and (v1.b<30);
        
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    where t1.a>5 group by a,b having max_c < 707) v1, 
      t2 where (v1.a=t2.a) and (v1.max_c>300) and (v1.a=v1.b);
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      where t1.a>5 group by a,b having max_c < 707) v1, 
        t2 where (v1.a=t2.a) and (v1.max_c>300) and (v1.a=v1.b); 
          
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    where t1.a>5 group by a,b having max_c < 707) v1,
  (select a, b, min(c) as min_c from t1
    where t1.a>5 group by a,b having min_c < 707) v2,
    t2 where (v1.a=v2.a) and (v1.b=t2.b) and (max_c>min_c);
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      where t1.a>5 group by a,b having max_c < 707) v1,
    (select a, b, min(c) as min_c from t1
      where t1.a>5 group by a,b having min_c < 707) v2,
      t2 where (v1.a=v2.a) and (v1.b=t2.b) and (v1.max_c>130) and (v2.min_c<130);
      
select * from
  (select a, b, max(c) as max_c, avg(c) as avg_c from t1
    where t1.a>5 group by a,b having max_c < 707) v1,
  (select a, b, min(c) as min_c from t1
    where t1.a>5 group by a,b having min_c < 707) v2,
  (select a, b, avg(c) as avg_c from t1
    where t1.a<8 group by a,b) v3,
    t2 where (v1.a=v2.a) and (v1.b=v3.b) and ((v3.avg_c>170) or (v3.a<5))
      and ((v1.avg_c<400) or (v1.a>1)) and (v2.min_c<200);      
explain format=json
  select * from
    (select a, b, max(c) as max_c, avg(c) as avg_c from t1
      where t1.a>5 group by a,b having max_c < 707) v1,
    (select a, b, min(c) as min_c from t1
      where t1.a>5 group by a,b having min_c < 707) v2,
    (select a, b, avg(c) as avg_c from t1
      where t1.a<8 group by a,b) v3,
      t2 where (v1.a=v2.a) and (v1.b=v3.b) and ((v3.avg_c>170) or (v3.a<5))
        and ((v1.avg_c<400) or (v1.a>1)) and (v2.min_c<200);
        
set optimizer_switch="condition_pushdown_for_derived=off";
select * from v1,t2 where (v1.a=t2.a) and (v1.b>2) and (v1.max_c>200);
explain format=json 
  select * from v1,t2 where (v1.a=t2.a) and (v1.b>2) and (v1.max_c>200);
  
set optimizer_switch="condition_pushdown_for_derived=on"; 
select * from v1,t2 where (v1.a=t2.a) and (v1.b>2) and (v1.max_c>200);
explain format=json 
  select * from v1,t2 where (v1.a=t2.a) and (v1.b>2) and (v1.max_c>200);
  
select * from v1,t2 where (v1.a<2) and (v1.b=t2.b) and (t2.c>800)
  union 
select * from v1,t2 where (v1.max_c>100) and (v1.a>7) and (t2.d>800);
explain format=json 
  select * from v1,t2 where (v1.a<5) and (v1.b=t2.b) and (t2.c>800)
    union
  select * from v1,t2 where (v1.max_c>100) and (v1.a>7) and (t2.d>800);      
      
select * from v1,t2 where (v1.a<5) and (v1.b=t2.b) and (v1.b=19)
  union 
select * from v1,t2 where ((v1.max_c>400) or (v1.avg_c>270)) and (v1.a<t2.a);
explain format=json 
  select * from v1,t2 where (v1.a<5) and (v1.b=t2.b) and (v1.b=19)
    union 
  select * from v1,t2 where ((v1.max_c>400) or (v1.avg_c>270)) and (v1.a<t2.a);
      
select * from v1,t2 where 
  (t2.a=v1.a) or (v1.b=t2.b) and ((v1.a=1) or (v1.a=6))
    union
select * from v1,t2 where ((v1.a>3) and (v1.b>27)) or (v1.max_c>550);      
explain format=json 
  select * from v1,t2 where 
    (t2.a=v1.a) or (v1.b=t2.b) and ((v1.a=1) or (v1.a=6))
      union
  select * from v1,t2 where ((v1.a>3) and (v1.b>27)) or (v1.max_c>550);    
  
select * from v1,t2 where 
  ((v1.a=1) and (v1.a=t2.a)) and ((v1.max_c<500) or (v1.avg_c>500))
    union
select * from v2,t2 where
  ((v2.a<t2.b) or (v2.max_c>200)) and (v2.b>10) and (t2.a<2)
    union
select * from v2,t2 where
  (v2.max_c=t2.c) and (v2.b<10);
explain format=json  
  select * from v1,t2 where 
    ((v1.a=1) and (v1.a=t2.a)) and ((v1.max_c<500) or (v1.avg_c>500))
      union
  select * from v2,t2 where
    ((v2.a<t2.b) or (v2.max_c>200)) and (v2.b>10) and (t2.a<2)
      union
  select * from v2,t2 where
    (v2.max_c=t2.c) and (v2.b<10);
    
create view v4 as 
  select a, b, min(c) as c from t1
    where t1.a<10 group by a,b having c > 109
      union
  select a, b, max(c) as c from t1
    where t1.b>10 group by a,b having c < 300;
    
select * from v4,t2 where (v4.a<3) and (v4.c>100);
explain format=json select * from v4,t2 where (v4.a<3) and (v4.c>100);

select * from v4,t2 where
  ((v4.a<2) or (v4.c>800)) and (v4.b>12);
explain format=json   
  select * from v4,t2 where
    ((v4.a<2) or (v4.c>800)) and (v4.b>12);
    
select * from v4,t2 where
  (v4.a=1) and (v4.a=t2.a) and (v4.c<200);
explain format=json 
  select * from v4,t2 where
    (v4.a=1) and (v4.a=t2.a) and (v4.c<200);
    
select * from v4,v1,t2 where
  (v4.a=v1.a) and (v1.a=t2.a) and (t2.a=1) and ((v4.c>800) or (v1.max_c>200));
explain format=json  
  select * from v4,v1,t2 where
    (v4.a=v1.a) and (v1.a=t2.a) and (t2.a=1) and ((v4.c>800) or (v1.max_c>200));    
    
create view v5 as 
  select a, b, min(c) as c from t1
    where t1.a<10 group by a,b having c > 109
      union
  select a, b, max(c) as c from t1
    where t1.b>10 group by a,b having c < 300
      union
  select a, b, avg(c) as c from t1
    where t1.c>300 group by a,b having c < 707;   
    
select * from v5,t2 where 
  ((v5.a=6) or (v5.a=8)) and (v5.c>200) and (v5.a=t2.a);
explain format=json 
  select * from v5,t2 where 
    ((v5.a=6) or (v5.a=8)) and (v5.c>200) and (v5.a=t2.a);
    
drop view v4,v5;

create table t3(a int, b double, c double);
insert into t3 values 
  (1,23.4,14.3333), (1,12.5,18.9), (3,12.5,18.9),
  (4,33.4,14.3333), (4,14.3333,13.65), (5,17.89,7.22),
  (6,33.4,14.3), (10,33.4,13.65), (11,33.4,13.65);
  
create table t4(a int, b double, c double);
insert into t4 values 
  (1,22.4,14.3333), (1,12.5,18.9), (2,22.4,18.9),
  (4,33.4,14.3333), (5,22.4,13.65), (7,17.89,18.9),
  (6,33.4,14.3333), (10,31.4,13.65), (12,33.4,13.65);  

create view v4 as
  select a, avg(a/4) as avg_a, b, c from t3
    where (b>12.2) group by b,c having (avg_a<22.333);
    
select * from v4,t4 where
  (v4.a=t4.a) and (v4.avg_a>0.45) and (v4.b>10);
explain format=json
  select * from v4,t4 where
    (v4.a=t4.a) and (v4.avg_a>0.45) and (v4.b>10);
    
select * from v4,t4 where
  (v4.b=v4.c) and (v4.c=t4.c) and ((t4.c>10) or (v4.a=1));    
explain format=json
  select * from v4,t4 where
    (v4.b=v4.c) and (v4.c=t4.c) and ((t4.c>10) or (v4.a=1));
    
select * from v4,t4 where
  (((v4.a>0.2) or (v4.b<17)) or (t4.c>17)) and (t4.c=v4.c) and (v4.c>18);
explain format=json  
  select * from v4,t4 where
    (((v4.a>0.2) or (v4.b<17)) or (t4.c>17)) and (t4.c=v4.c) and (v4.c>18);  
    
drop table t3,t4;
drop view v4;

create table t3(a char, b char(8), c int);
insert into t3 values
  ('a','Ivan',1), ('b','Vika',2), ('b','Inga',6), ('c','Vika',7),
  ('b','Ivan',7), ('a','Alex',6), ('b','Inga',5), ('d','Ron',9),
  ('d','Harry',2), ('d','Hermione',3), ('c','Ivan',3), ('c','Harry',4); 
  
create table t4(a char, b char(8), c int);
insert into t4 values
  ('b','Ivan',1), ('c','Vinny',3), ('c','Inga',9), ('a','Vika',1),
  ('c','Ivan',2), ('b','Ali',6), ('c','Inga',2), ('a','Ron',9),
  ('d','Harry',1), ('b','Hermes',3), ('b','Ivan',11), ('b','Harry',4); 
  
create view v4 as 
  select a, b, max(c) as max_c from t3 group by a,b having max_c < 9;
  
select * from v4,t4 where 
  (v4.a=t4.a) and (v4.b='Vika') and (v4.max_c>2);  
explain format=json
  select * from v4,t4 where 
    (v4.a=t4.a) and (v4.b='Vika') and (v4.max_c>2);
        
select * from v4,t4 where 
  (v4.a=t4.a) and (t4.a='b') and ((v4.b='Vika') or (v4.b='Ali'));  
explain format=json
  select * from v4,t4 where 
    (v4.a=t4.a) and (t4.a='b') and ((v4.b='Vika') or (v4.b='Ali'));
    
select * from v4,t4 where 
  (v4.a='c') and (v4.b<'Hermes') and ((v4.b=t4.b) or (v4.max_c>20));  
explain format=json
  select * from v4,t4 where 
    (v4.a='c') and (v4.b<'Hermes') and ((v4.b=t4.b) or (v4.max_c>20));  
    
drop table t3,t4;
drop view v4;
        
create view v4 as
  select a, b, min(max_c) as min_c from v1
    where (v1.a<15) group by a,b;
    
select * from v4,v1 where
  (v4.a<13) and (v1.a>5) and (v1.b>12);
explain format=json
  select * from v4,v1 where
    (v4.a<13) and (v1.a>5) and (v1.b>12);
    
select * from v4,v1,t2 where
  (v4.a=t2.a) and (v4.a=v1.a) and (v1.b>30);
explain format=json
  select * from v4,v1,t2 where
    (v4.a=t2.a) and (v4.a=v1.a) and (v1.b>30);
    
select * from v4,v1,t2 where
  (v4.a=t2.a) and (v4.a>1) and (v4.a=v1.a) and (v4.min_c>100) and (v1.b<30);    
explain format=json
  select * from v4,v1,t2 where
    (v4.a=t2.a) and (v4.a>1) and (v4.a=v1.a) and (v4.min_c>100) and (v1.b<30);  

select * from v4,v1 where
  (((v4.b>10) and (v4.a>1)) or (v4.b<20)) and (v1.max_c>200); 
explain format=json
  select * from v4,v1,t2 where
    (((v4.b>10) and (v4.a>1)) or (v4.b<20)) and (v1.max_c>200) and (v1.a=v4.a);        

drop view v1,v2,v3,v4;
drop table t1,t2;      